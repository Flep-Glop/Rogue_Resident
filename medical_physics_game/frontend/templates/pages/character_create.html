{% extends "base.html" %}

{% block title %}Create Character{% endblock %}

{% block additional_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/screens/character_create.css') }}">
<!-- Add Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
{% endblock %}

{% block content %}
<div class="pixel-container" data-screen="character-create">
    <!-- Animated star background -->
    <div class="star-bg" id="star-bg"></div>
    
    <div class="creation-container">
        <h1 class="game-title">CHARACTER CREATION</h1>
        <p class="subtitle">Customize your medical physics hero</p>
        
        <!-- Tabbed Interface -->
        <div class="creation-tabs">
            <div class="creation-tab active" data-tab="avatar">
                <span class="creation-tab-number">1</span>
                <span>Avatar</span>
            </div>
            <div class="creation-tab" data-tab="class">
                <span class="creation-tab-number">2</span>
                <span>Class</span>
            </div>
            <div class="creation-tab" data-tab="attributes">
                <span class="creation-tab-number">3</span>
                <span>Attributes</span>
            </div>
            <div class="creation-tab" data-tab="abilities">
                <span class="creation-tab-number">4</span>
                <span>Abilities</span>
            </div>
            <div class="creation-tab" data-tab="preview">
                <span class="creation-tab-number">5</span>
                <span>Preview</span>
            </div>
        </div>
        
        <!-- Avatar Selection Tab -->
        <div class="tab-content active" id="avatar-tab">
            <div class="avatar-selection">
                <div class="avatar-preview">
                    <img id="selected-avatar-preview" src="{{ url_for('static', filename='img/characters/physicist.png') }}" alt="Character Avatar">
                </div>
                
                <div class="avatar-rotation-ui">
                    <button class="rotation-button" id="rotate-left">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div class="avatar-label">Rotate Avatar</div>
                    <button class="rotation-button" id="rotate-right">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                
                <div class="avatar-grid" id="avatar-grid">
                    <!-- Avatars will be populated by JavaScript -->
                </div>
            </div>
            
            <div class="creation-actions">
                <div class="nav-buttons">
                    <a href="{{ url_for('character_select') }}" class="action-button prev-button">
                        <i class="fas fa-arrow-left"></i> Back
                    </a>
                    <button class="action-button next-button" data-next-tab="class">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Class Selection Tab -->
        <div class="tab-content" id="class-tab">
            <div class="class-selection">
                <div class="class-cards" id="class-cards">
                    <!-- Class cards will be populated by JavaScript -->
                </div>
            </div>
            
            <div class="creation-actions">
                <div class="nav-buttons">
                    <button class="action-button prev-button" data-prev-tab="avatar">
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <button class="action-button next-button" data-next-tab="attributes">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Attributes Tab -->
        <div class="tab-content" id="attributes-tab">
            <div class="attributes-section">
                <div class="attribute-points">
                    <div class="points-label">Points Remaining:</div>
                    <div class="points-value" id="points-remaining">15</div>
                </div>
                
                <div class="attribute-groups">
                    <div class="attribute-group">
                        <div class="attribute-header">
                            <div class="attribute-name">
                                <i class="fas fa-brain"></i> Intelligence
                            </div>
                            <div class="attribute-value-display" id="intelligence-value">5</div>
                        </div>
                        <div class="attribute-slider-container">
                            <input type="range" min="1" max="10" value="5" class="attribute-slider" id="intelligence-slider">
                            <div class="attribute-progress intelligence" style="width: 50%" id="intelligence-progress"></div>
                        </div>
                        <div class="attribute-description">
                            Affects problem-solving ability and knowledge retention
                        </div>
                    </div>
                    
                    <div class="attribute-group">
                        <div class="attribute-header">
                            <div class="attribute-name">
                                <i class="fas fa-shield-alt"></i> Persistence
                            </div>
                            <div class="attribute-value-display" id="persistence-value">5</div>
                        </div>
                        <div class="attribute-slider-container">
                            <input type="range" min="1" max="10" value="5" class="attribute-slider" id="persistence-slider">
                            <div class="attribute-progress persistence" style="width: 50%" id="persistence-progress"></div>
                        </div>
                        <div class="attribute-description">
                            Affects stamina and ability to overcome challenges
                        </div>
                    </div>
                    
                    <div class="attribute-group">
                        <div class="attribute-header">
                            <div class="attribute-name">
                                <i class="fas fa-random"></i> Adaptability
                            </div>
                            <div class="attribute-value-display" id="adaptability-value">5</div>
                        </div>
                        <div class="attribute-slider-container">
                            <input type="range" min="1" max="10" value="5" class="attribute-slider" id="adaptability-slider">
                            <div class="attribute-progress adaptability" style="width: 50%" id="adaptability-progress"></div>
                        </div>
                        <div class="attribute-description">
                            Affects how well you handle unexpected situations
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="creation-actions">
                <div class="nav-buttons">
                    <button class="action-button prev-button" data-prev-tab="class">
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <button class="action-button next-button" data-next-tab="abilities">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Abilities Tab -->
        <div class="tab-content" id="abilities-tab">
            <div class="abilities-section">
                <div class="abilities-container">
                    <div class="abilities-column">
                        <div class="abilities-header">
                            Available Abilities
                            <div class="abilities-count">
                                <span id="available-count">12</span> abilities
                            </div>
                        </div>
                        
                        <div class="abilities-search">
                            <i class="fas fa-search search-icon"></i>
                            <input type="text" class="search-input" id="ability-search" placeholder="Search abilities...">
                        </div>
                        
                        <div class="abilities-filters">
                            <button class="filter-button active" data-category="all">All</button>
                            <button class="filter-button" data-category="Academic">Academic</button>
                            <button class="filter-button" data-category="Clinical">Clinical</button>
                            <button class="filter-button" data-category="Professional">Professional</button>
                            <button class="filter-button" data-category="Technical">Technical</button>
                        </div>
                        
                        <div class="abilities-list" id="available-abilities">
                            <!-- Available abilities will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <div class="abilities-column">
                        <div class="abilities-header">
                            Selected Abilities
                            <div class="abilities-count">
                                <span id="selected-count">0</span>/2 slots
                            </div>
                        </div>
                        
                        <div class="abilities-list" id="selected-abilities">
                            <!-- Selected abilities will be populated by JavaScript -->
                            <div class="no-abilities">
                                <div class="no-abilities-icon">
                                    <i class="fas fa-magic"></i>
                                </div>
                                <p>Select up to two abilities from the available list</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="creation-actions">
                <div class="nav-buttons">
                    <button class="action-button prev-button" data-prev-tab="attributes">
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <button class="action-button next-button" data-next-tab="preview">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Preview Tab -->
        <div class="tab-content" id="preview-tab">
            <div class="character-preview">
                <div class="preview-card">
                    <div class="preview-header">
                        <div class="preview-avatar">
                            <img id="preview-avatar-img" src="{{ url_for('static', filename='img/characters/physicist.png') }}" alt="Character">
                        </div>
                        
                        <div class="preview-info">
                            <h2 class="preview-name" id="preview-name">New Character</h2>
                            <div class="preview-class" id="preview-class">No Class Selected</div>
                            
                            <div class="preview-stats">
                                <div class="preview-stat">
                                    <div class="preview-stat-value" id="preview-intelligence">5</div>
                                    <div class="preview-stat-label">Intelligence</div>
                                </div>
                                
                                <div class="preview-stat">
                                    <div class="preview-stat-value" id="preview-persistence">5</div>
                                    <div class="preview-stat-label">Persistence</div>
                                </div>
                                
                                <div class="preview-stat">
                                    <div class="preview-stat-value" id="preview-adaptability">5</div>
                                    <div class="preview-stat-label">Adaptability</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="preview-details">
                        <div class="preview-section">
                            <div class="preview-section-title">Abilities</div>
                            <div class="preview-abilities" id="preview-abilities">
                                <!-- Will be populated by JavaScript -->
                                <span class="no-abilities">No abilities selected</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="creation-actions">
                <div class="nav-buttons">
                    <button class="action-button prev-button" data-prev-tab="abilities">
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <button class="action-button create-button" id="create-character-btn">
                        <i class="fas fa-save"></i> Create Character
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block additional_js %}
<script src="{{ url_for('static', filename='js/character_assets.js') }}"></script>
<script src="{{ url_for('static', filename='js/character_creator.js') }}"></script>
<script>
    // Generate star background
    document.addEventListener('DOMContentLoaded', function() {
        const starBg = document.getElementById('star-bg');
        for (let i = 0; i < 100; i++) {
            const star = document.createElement('div');
            star.className = 'star';
            star.style.left = `${Math.random() * 100}%`;
            star.style.top = `${Math.random() * 100}%`;
            star.style.animationDelay = `${Math.random() * 4}s`;
            star.style.width = `${1 + Math.random() * 2}px`;
            star.style.height = star.style.width;
            starBg.appendChild(star);
        }
    });
</script>
{% endblock %}