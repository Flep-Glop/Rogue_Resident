<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/static/css/main.css" rel="stylesheet">
</head>
<body>
    <div class="pixel-container">
        <!-- CRT and scanline effects -->
        <div class="scanlines"></div>
        <div class="crt-effect"></div>
        
        <!-- Replace your current title/subtitle section with this -->
        <div class="title-block">
            <h1 class="game-title">ROGUE<br>RESIDENT</h1>
            <p class="subtitle">THE ROGUELIKE STUDY TOOL</p>
        </div>
        
        <!-- Main menu -->
        <div class="menu-container">
            <button class="retro-btn start" id="start-game">New Game</button>
            <button class="retro-btn" id="continue-game">Continue</button>
            <button class="retro-btn options" id="options">Options</button>
            <button class="retro-btn help" id="help">Help</button>
        </div>
        
        <!-- Decorative pixel elements -->
        <div id="pixel-decorations"></div>
        
        <!-- Footer -->
        <div class="footer">
            <p>v0.1.0 | Press SPACE to start</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Create pixel decorations
            createPixelDecorations();
            
            // Button sound effect
            function playButtonSound() {
                // When we add audio files, we'll uncomment this
                // const sound = new Audio('/static/audio/click.mp3');
                // sound.volume = 0.3;
                // sound.play();
            }
            
            // IMPORTANT: Make sure these event listeners are preserved!
            document.getElementById('start-game').addEventListener('click', function() {
                playButtonSound();
                window.location.href = '/character-select'; 
            });
            
            document.getElementById('continue-game').addEventListener('click', function() {
                playButtonSound();
                // For now just redirect to game
                window.location.href = '/game';
            });
            
            document.getElementById('options').addEventListener('click', function() {
                playButtonSound();
                alert('Options will be available in the next update!');
            });
            
            document.getElementById('help').addEventListener('click', function() {
                playButtonSound();
                alert('Welcome to Medical Physics Residency! Navigate through each floor, answer questions correctly to gain insight, and avoid losing all your lives. Good luck!');
            });
            
            // Keyboard controls
            document.addEventListener('keydown', function(event) {
                if (event.code === 'Space') {
                    playButtonSound();
                    window.location.href = '/game';
                }
            });
        });
        
        function createPixelDecorations() {
            const decorationContainer = document.getElementById('pixel-decorations');
            if (!decorationContainer) return;
            
            // Clear existing decorations
            decorationContainer.innerHTML = '';
            
            // Color palette based exactly on the screenshot
            const colors = [
                '#5b8dd9', // primary blue 
                '#8be8e5', // cyan
                '#a7a1db', // light purple
                '#ffffff', // white (for small dots)
            ];
            
            // Create a grid background
            if (!document.getElementById('grid-background')) {
                const gridBg = document.createElement('div');
                gridBg.id = 'grid-background';
                gridBg.style.position = 'absolute';
                gridBg.style.top = '0';
                gridBg.style.left = '0';
                gridBg.style.width = '100%';
                gridBg.style.height = '100%';
                gridBg.style.backgroundImage = 'linear-gradient(rgba(255, 255, 255, 0.07) 1px, transparent 1px), linear-gradient(90deg, rgba(255, 255, 255, 0.07) 1px, transparent 1px)';
                gridBg.style.backgroundSize = '20px 20px';
                gridBg.style.pointerEvents = 'none';
                gridBg.style.zIndex = '-1';
                document.querySelector('.pixel-container').insertBefore(gridBg, decorationContainer);
            }
            
            // MASSIVELY increase shape count
            const shapeCount = 250; // Much higher count as requested
            
            for (let i = 0; i < shapeCount; i++) {
                const decoration = document.createElement('div');
                decoration.classList.add('pixel-decoration');
                
                // Position across entire viewport
                const x = Math.random() * 100;
                const y = Math.random() * 100;
                
                // Varied sizes matching the screenshot (mostly small with some larger elements)
                let size;
                if (Math.random() > 0.85) {
                    // Larger shapes (less common)
                    size = 15 + Math.floor(Math.random() * 30);
                } else {
                    // Smaller shapes (more common)
                    size = 2 + Math.floor(Math.random() * 12);
                }
                
                // Colors from palette
                const colorIndex = Math.floor(Math.random() * colors.length);
                const color = colors[colorIndex];
                
                // Outline vs filled (heavily favoring outlines as in the image)
                const hasOutlineOnly = Math.random() > 0.1; // 90% outlines
                
                // Apply base styles
                decoration.style.left = `${x}vw`;
                decoration.style.top = `${y}vh`;
                decoration.style.width = `${size}px`;
                decoration.style.height = `${size}px`;
                
                if (hasOutlineOnly) {
                    decoration.style.backgroundColor = 'transparent';
                    decoration.style.border = `1px solid ${color}`;
                    decoration.style.boxShadow = `0 0 2px ${color}`;
                } else {
                    decoration.style.backgroundColor = color;
                    decoration.style.opacity = '0.3';
                }
                
                // Based on the screenshot: mostly squares and circles
                const shapeType = Math.random() > 0.4 ? 'square' : 'circle';
                
                if (shapeType === 'circle') {
                    decoration.style.borderRadius = '50%';
                }
                
                // Add lots of tiny dots/stars
                if (size <= 3) {
                    decoration.style.backgroundColor = '#ffffff';
                    decoration.style.border = 'none';
                    decoration.style.opacity = Math.random() * 0.5 + 0.1; // Varied opacity
                }
                
                // Subtle animations - not too fast to maintain the calm space-like feel
                const animationType = Math.random();
                
                if (animationType < 0.4) {
                    const floatDuration = 20 + Math.random() * 40;
                    decoration.style.animation = `pixel-float ${floatDuration}s infinite ease-in-out`;
                } 
                else if (animationType < 0.8 && shapeType === 'square') {
                    decoration.style.animation = `slow-rotate ${40 + Math.random() * 80}s linear infinite, pixel-float ${35 + Math.random() * 25}s infinite ease-in-out`;
                }
                else {
                    decoration.style.animation = `pixel-twinkle ${15 + Math.random() * 25}s infinite ease-in-out`;
                }
                
                decorationContainer.appendChild(decoration);
            }
        }

        // Refresh occasionally
        setInterval(createPixelDecorations, 180000); // Every 3 minutes
    </script>
</body>
</html>